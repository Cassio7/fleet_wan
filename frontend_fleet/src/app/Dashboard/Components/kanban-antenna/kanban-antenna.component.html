<div class="container">
  <app-kanban-filters></app-kanban-filters>
  <div class="columns">
    <!-- Working Column -->
    <div class="working-col">
      <div class="header">
        <div class="OK-container">
          <mat-icon class="wifiIcon-OK">wifi</mat-icon>
          OK
        </div>
        <span class="nMezzi">{{ kanbanAntennaService.workingVehicles.length }}</span>
      </div>
      <span>{{ kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.workingVehicles).toFixed(0) + '%' }}</span>
      <mat-progress-bar
        mode="determinate"
        [matTooltip]="kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.workingVehicles).toFixed(0) + '%'"
        [value]="kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.workingVehicles)"
        class="progress-bar working-bar"
        color="accent">
      </mat-progress-bar>
      <div class="scrollable-list">
        <mat-list>
          <mat-list-item *ngFor="let vehicleData of kanbanAntennaService.workingVehicles">
            <div class="vehicle" >
              <div class="info" matTooltip="Antenna funzionante">
                <p class="type">{{'Tipologia non disponibile' }}</p>
                <p class="cantiere">{{ vehicleData.vehicle.worksite?.name || 'Non assegnato' }}</p>
              </div>
              <div class="right-container">
                <p class="plate" matTooltip="Antenna funzionante">{{ vehicleData.vehicle.plate }}</p>
                <button mat-button class="map-btn" matTooltip="Click per visualizzare l'ultima posizione registrata sulla mappa" (click)="showMap(vehicleData)"><mat-icon>map</mat-icon></button>
              </div>
            </div>
          </mat-list-item>
        </mat-list>
      </div>
    </div>

    <!-- Error Column -->
    <div class="error-col">
      <div class="header">
        <div class="error-container">
          <mat-icon class="errorIcon-error">wifi</mat-icon>
          Error
        </div>
        <span class="nMezzi">{{ kanbanAntennaService.errorVehicles.length }}</span>
      </div>
      <span>{{ kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.errorVehicles).toFixed(0) + '%' }}</span>
      <mat-progress-bar
        mode="determinate"
        [matTooltip]="kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.errorVehicles).toFixed(0) + '%'"
        [value]="kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.errorVehicles)"
        class="progress-bar error-bar"
        color="warn">
      </mat-progress-bar>
      <div class="scrollable-list">
        <mat-list>
          <mat-list-item *ngFor="let vehicleData of kanbanAntennaService.errorVehicles">
            <div class="vehicle">
              <div class="info" [matTooltip]="checkErrorsService.checkVehicleAntennaError(vehicleData)">
                <p class="type">{{'Tipologia non disponibile' }}</p>
                <p class="cantiere">{{ vehicleData.vehicle.worksite?.name || 'Non assegnato' }}</p>
              </div>
              <div class="right-container">
                <p class="plate" [matTooltip]="checkErrorsService.checkVehicleAntennaError(vehicleData)">{{ vehicleData.vehicle.plate }}</p>
                <button mat-button class="map-btn" matTooltip="Click per visualizzare l'ultima posizione registrata sulla mappa" (click)="showMap(vehicleData)"><mat-icon>map</mat-icon></button>
              </div>
            </div>
          </mat-list-item>
        </mat-list>
      </div>
    </div>

    <!-- No Antenna Column -->
    <div class="blackbox-col">
      <div class="header">
        <div class="blackbox-container">
          <mat-icon class="wifiIcon-blackbox">wifi</mat-icon>
          No antenna
        </div>
        <span class="nMezzi">{{ kanbanAntennaService.blackboxVehicles.length }}</span>
      </div>
      <span>{{ kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.blackboxVehicles).toFixed(0) + '%' }}</span>
      <mat-progress-bar
        mode="determinate"
        [matTooltip]="kanbanAntennaService.getVehiclesPercentage(kanbanAntennaService.blackboxVehicles).toFixed(0) + '%'"
        [value]="(kanbanAntennaService.blackboxVehicles.length / kanbanAntennaService.getAllKanbanVehicles().length) * 100"
        class="progress-bar blackbox-bar"
        color="primary">
      </mat-progress-bar>
      <div class="scrollable-list">
        <mat-list>
          <mat-list-item *ngFor="let vehicleData of kanbanAntennaService.blackboxVehicles">
            <div class="vehicle">
              <div class="info" matTooltip="No antenna">
                <p class="type">{{'Tipologia non disponibile' }}</p>
                <p class="cantiere">{{ vehicleData.vehicle.worksite?.name || 'Non assegnato' }}</p>
              </div>
              <div class="right-container">
                <p class="plate" matTooltip="No antenna">{{ vehicleData.vehicle.plate }}</p>
                <button mat-button class="map-btn" matTooltip="Click per visualizzare l'ultima posizione registrata sulla mappa" (click)="showMap(vehicleData)"><mat-icon>map</mat-icon></button>
              </div>
            </div>
          </mat-list-item>
        </mat-list>
      </div>
    </div>
  </div>
</div>
